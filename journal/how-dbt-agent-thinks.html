<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>How dbt-agent Thinks | Keith Binkly</title>
  <meta name="description" content="Architecture overview of dbt-agent—how knowledge flows through the system.">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=IBM+Plex+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-base: #0d0d0d;
      --bg-surface: #111;
      --bg-card: #161616;
      --border-dim: #222;
      --border-mid: #333;
      --text-dim: #6b6b6b;
      --text-mid: #a0a0a0;
      --text-bright: #d4d4d4;
      --text-white: #f5f5f5;
      --accent: #d4a84b;
      --link: #7db4c9;
      --space-xs: 0.5rem;
      --space-sm: 1rem;
      --space-md: 1.5rem;
      --space-lg: 3rem;
      --space-xl: 4.5rem;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { font-size: 18px; }
    body {
      min-height: 100vh;
      font-family: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-base);
      color: var(--text-bright);
      line-height: 1.7;
      -webkit-font-smoothing: antialiased;
    }

    .container {
      max-width: 680px;
      margin: 0 auto;
      padding: var(--space-xl) var(--space-md);
    }

    a { color: var(--link); text-decoration: none; }
    a:hover { color: var(--text-white); }

    .back-link {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-dim);
      display: inline-block;
      margin-bottom: var(--space-lg);
    }

    .back-link:hover { color: var(--link); }

    .article-meta {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--text-dim);
      margin-bottom: var(--space-sm);
    }

    h1 {
      font-size: 1.75rem;
      font-weight: 600;
      color: var(--text-white);
      margin-bottom: var(--space-lg);
      line-height: 1.3;
    }

    .article-content p {
      margin-bottom: var(--space-md);
      font-size: 1rem;
      line-height: 1.8;
    }

    .article-content strong {
      color: var(--text-white);
      font-weight: 500;
    }

    .divider {
      width: 40px;
      height: 1px;
      background: var(--border-mid);
      margin: var(--space-lg) 0;
    }

    .article-content ul {
      margin-bottom: var(--space-md);
      padding-left: var(--space-md);
    }

    .article-content li {
      margin-bottom: var(--space-xs);
      color: var(--text-mid);
    }

    .architecture-diagram {
      background: var(--bg-surface);
      border: 1px solid var(--border-dim);
      border-radius: 6px;
      padding: var(--space-md);
      margin: var(--space-md) 0 var(--space-lg);
      overflow-x: auto;
    }

    .architecture-diagram pre {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      line-height: 1.5;
      color: var(--text-mid);
      margin: 0;
    }

    .highlight {
      color: var(--accent);
    }

    .next-section {
      margin-top: var(--space-xl);
      padding-top: var(--space-lg);
      border-top: 1px solid var(--border-dim);
    }

    .next-section h3 {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: var(--space-sm);
    }

    .next-section ul {
      list-style: none;
      padding: 0;
    }

    .next-section li {
      margin-bottom: var(--space-xs);
    }

    .next-section a {
      font-size: 0.95rem;
    }

    code {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      background: var(--bg-surface);
      padding: 2px 6px;
      border-radius: 3px;
      color: var(--accent);
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="../index.html" class="back-link">← back</a>

    <article>
      <div class="article-meta">January 2026</div>
      <h1>How dbt-agent Thinks</h1>

      <div class="article-content">
        <p>The core insight behind dbt-agent: AI agents fail on enterprise data not because they're stupid, but because they're missing context that humans take for granted.</p>

        <p>When a senior analyst decides where to put a new model, they're drawing on:</p>
        <ul>
          <li>Years of accumulated patterns</li>
          <li>Knowledge of what already exists</li>
          <li>Understanding of team conventions</li>
          <li>Awareness of edge cases from past mistakes</li>
        </ul>

        <p>AI doesn't have any of that. Unless you give it to them.</p>

        <div class="divider"></div>

        <p><strong>The architecture</strong></p>

        <div class="architecture-diagram">
<pre>┌─────────────────────────────────────────────────────┐
│            USER REQUEST                             │
└─────────────────────────┬───────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────┐
│            ORCHESTRATOR (Claude Code)               │
│                                                     │
│  • Interprets request                               │
│  • Determines which skills to load                  │
│  • Manages 4-phase workflow                         │
│  • Enforces human approval gates                    │
└─────────────────────────┬───────────────────────────┘
                          │
          ┌───────────────┼───────────────┐
          ▼               ▼               ▼
    ┌──────────┐    ┌──────────┐    ┌──────────┐
    │ SKILL:   │    │ SKILL:   │    │ SKILL:   │
    │ Discovery│    │ Migration│    │ QA       │
    └────┬─────┘    └────┬─────┘    └────┬─────┘
          │               │               │
          └───────────────┴───────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────┐
│            UNIFIED RETRIEVAL                        │
│                                                     │
│  • Knowledge Graph (21K+ chunks)                    │
│  • Experience Store (cross-agent solutions)         │
│  • Canonical Models Registry                        │
│  • Manifest Parser (dbt project metadata)           │
└─────────────────────────────────────────────────────┘</pre>
        </div>

        <div class="divider"></div>

        <p><strong>Skills: Domain-specific knowledge packages</strong></p>

        <p>Each skill is a structured knowledge bundle that loads when relevant. Examples:</p>

        <p><strong>Data Discovery Skill</strong></p>
        <ul>
          <li>How to explore unfamiliar data</li>
          <li>Questions to ask stakeholders</li>
          <li>Documentation templates</li>
        </ul>

        <p><strong>Migration Skill</strong></p>
        <ul>
          <li>6-step legacy SQL refactoring playbook</li>
          <li>Pattern recognition for common transformations</li>
          <li>QA validation requirements</li>
        </ul>

        <p><strong>Folder Structure Skill</strong></p>
        <ul>
          <li>Where each model type belongs</li>
          <li>Naming conventions</li>
          <li>When to create new directories</li>
        </ul>

        <p>The agent doesn't load all 36 skills at once. It loads what's relevant to the current task—keeping context focused and token usage efficient.</p>

        <div class="divider"></div>

        <p><strong>The 4-phase workflow</strong></p>

        <p>Every significant task follows the same structure:</p>

        <ul>
          <li><strong>Requirements</strong>: What are we building? What does success look like?</li>
          <li><strong>Discovery</strong>: What exists? What patterns apply? What constraints matter?</li>
          <li><strong>Architecture</strong>: How should this be structured? (Human approval gate)</li>
          <li><strong>Implementation</strong>: Build it, test it, document it</li>
        </ul>

        <p>Human approval gates pause the workflow at critical transitions. The agent proposes; the human validates. This isn't optional—it's enforced.</p>

        <div class="divider"></div>

        <p><strong>Unified retrieval: One API for all context</strong></p>

        <p>The agent doesn't know where knowledge lives. It just asks.</p>

        <p><code>unified_retrieval("how do we handle merchant name normalization")</code></p>

        <p>The system checks:</p>
        <ul>
          <li><strong>Knowledge Graph</strong>: Is there documentation about this?</li>
          <li><strong>Experience Store</strong>: Has another agent solved this before?</li>
          <li><strong>Canonical Models</strong>: Does a pattern already exist?</li>
          <li><strong>Manifest</strong>: What's currently in the dbt project?</li>
        </ul>

        <p>Results come back ranked by relevance. The agent uses what's useful, ignores what isn't.</p>

        <div class="divider"></div>

        <p><strong>Why this works</strong></p>

        <p>Traditional approaches to "AI + enterprise data":</p>
        <ul>
          <li><strong>Fine-tuning</strong>: Expensive, hard to update, can't handle fast-changing codebases</li>
          <li><strong>RAG over docs</strong>: Retrieves text, but text isn't structured knowledge</li>
          <li><strong>Prompt engineering</strong>: Works for simple cases, fails at scale</li>
        </ul>

        <p>dbt-agent takes a different approach: <strong>curated, structured knowledge that the agent can reason over</strong>.</p>

        <p>The knowledge base isn't a pile of documents. It's organized into skills, indexed for semantic search, and designed to answer the specific questions agents ask.</p>

        <div class="divider"></div>

        <p><strong>What I'm still figuring out</strong></p>

        <ul>
          <li>How to make knowledge curation sustainable (it takes real time)</li>
          <li>When to trust agent judgment vs. require human approval</li>
          <li>How to measure knowledge base quality over time</li>
          <li>Whether this approach generalizes beyond dbt</li>
        </ul>

        <p>More on these in future posts.</p>

        <div class="next-section">
          <h3>In this series</h3>
          <ul>
            <li><a href="why-i-built-dbt-agent.html">← Why I Built dbt-agent</a></li>
            <li><a href="qa-methodology.html">The QA Methodology That Changed Everything →</a></li>
          </ul>
        </div>
      </div>
    </article>
  </div>
</body>
</html>
